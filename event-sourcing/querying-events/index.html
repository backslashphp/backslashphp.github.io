<!doctype html><html lang=en-ca dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Querying Events#
Queries define which events should be loaded from the EventStore. They act as dynamic consistency boundaries, allowing
you to load exactly the events needed to make a specific decision. The boundaries are determined at runtime based on the
operation being performed, not predefined at design time.
Queries also play a crucial role in optimistic concurrency control. Before appending new events, the query is
re-executed to verify that no other process has added events to the stream in the meantime."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://backslashphp.github.io/backslash/event-sourcing/querying-events/"><meta property="og:site_name" content="Backslash PHP Developer Guide"><meta property="og:title" content="Querying Events"><meta property="og:description" content="Querying Events# Queries define which events should be loaded from the EventStore. They act as dynamic consistency boundaries, allowing you to load exactly the events needed to make a specific decision. The boundaries are determined at runtime based on the operation being performed, not predefined at design time.
Queries also play a crucial role in optimistic concurrency control. Before appending new events, the query is re-executed to verify that no other process has added events to the stream in the meantime."><meta property="og:locale" content="en_ca"><meta property="og:type" content="article"><meta property="article:section" content="event-sourcing"><meta property="article:modified_time" content="2025-11-11T17:09:05-05:00"><title>Querying Events | Backslash PHP Developer Guide</title><link rel=icon href=/backslash/favicon.png><link rel=manifest href=/backslash/manifest.json><link rel=canonical href=https://backslashphp.github.io/backslash/event-sourcing/querying-events/><link rel=stylesheet href=/backslash/book.min.c0e41de750417a94c4724981669dbe7955cfa422e1b2a84d4d2ac5e7d4a300f2.css integrity="sha256-wOQd51BBepTEckmBZp2+eVXPpCLhsqhNTSrF59SjAPI=" crossorigin=anonymous><script defer src=/backslash/fuse.min.js></script><script defer src=/backslash/en.search.min.bf5cf25dfd21948ac026e92ebfbb526af7dc35e848feb1e5549f4f2ff0904a2c.js integrity="sha256-v1zyXf0hlIrAJukuv7tSavfcNehI/rHlVJ9PL/CQSiw=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-event-sourcing"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/backslash/><span>Backslash PHP Developer Guide</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=https://github.com/backslashphp/backslash target=_blank rel=noopener>Source code</a></li><li><a href=https://github.com/backslashphp/demo target=_blank rel=noopener>Demo application</a></li></ul><ul><li class=book-section-flat><a>Getting Started</a><ul><li><a href=/backslash/getting-started/introduction/>Introduction</a></li><li><a href=/backslash/getting-started/architecture-overview/>Architecture Overview</a></li><li><a href=/backslash/getting-started/quick-start-guide/>Quick Start Guide</a></li></ul></li><li class=book-section-flat><a>Event Sourcing</a><ul><li><a href=/backslash/event-sourcing/understanding-event-sourcing/>Understanding Event Sourcing</a></li><li><a href=/backslash/event-sourcing/defining-events/>Defining Events</a></li><li><a href=/backslash/event-sourcing/querying-events/ class=active>Querying Events</a></li><li><a href=/backslash/event-sourcing/building-models/>Building Models</a></li></ul></li><li class=book-section-flat><a>Commands and Projections (CQRS)</a><ul><li><a href=/backslash/cqrs/understanding-cqrs/>Understanding CQRS</a></li><li><a href=/backslash/cqrs/dispatching-commands/>Dispatching Commands</a></li><li><a href=/backslash/cqrs/reacting-with-event-handlers/>Reacting with Event Handlers</a></li><li><a href=/backslash/cqrs/building-projections/>Building Projections</a></li></ul></li><li class=book-section-flat><a>Testing Your Application</a><ul><li><a href=/backslash/testing/setting-up-tests/>Setting Up Tests</a></li><li><a href=/backslash/testing/writing-test-scenarios/>Writing Test Scenarios</a></li></ul></li><li class=book-section-flat><a>Customization</a><ul><li><a href=/backslash/customization/extending-with-middleware/>Extending with Middleware</a></li><li><a href=/backslash/customization/enriching-event-streams/>Enriching Event Streams</a></li></ul></li><li class=book-section-flat><a>Application Setup</a><ul><li><a href=/backslash/application-setup/defining-services/>Defining Services</a></li><li><a href=/backslash/application-setup/registering-handlers/>Registering Handlers</a></li><li><a href=/backslash/application-setup/using-the-bootstrap-file/>Using the Bootstrap File</a></li></ul></li><li class=book-section-flat><a>Maintenance</a><ul><li><a href=/backslash/maintenance/rebuilding-projections/>Rebuilding Projections</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/backslash/icons/menu.svg class=book-icon alt=Menu></label><h3>Querying Events</h3><label for=toc-control><img src=/backslash/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#understanding-queries>Understanding queries</a></li><li><a href=#building-queries-with-eventclass-and-identifier>Building queries with EventClass and Identifier</a></li><li><a href=#building-multi-entity-queries>Building multi-entity queries</a></li><li><a href=#best-practices>Best practices</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=querying-events>Querying Events<a class=anchor href=#querying-events>#</a></h1><p>Queries define which events should be loaded from the EventStore. They act as dynamic consistency boundaries, allowing
you to load exactly the events needed to make a specific decision. The boundaries are determined at runtime based on the
operation being performed, not predefined at design time.</p><p>Queries also play a crucial role in optimistic concurrency control. Before appending new events, the query is
re-executed to verify that no other process has added events to the stream in the meantime.</p><h2 id=understanding-queries>Understanding queries<a class=anchor href=#understanding-queries>#</a></h2><p>Queries implement <code>QueryInterface</code> and describe which events to fetch based on event class and identifiers.</p><p>Here are some basic query examples:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Load all events of a specific type
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#a6e22e>StudentRegisteredEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Load events for a specific entity
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;studentId&#39;</span>, <span style=color:#e6db74>&#39;student-123&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Combine filters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#a6e22e>StudentRegisteredEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>)
</span></span><span style=display:flex><span>    <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>and</span>(<span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;studentId&#39;</span>, <span style=color:#e6db74>&#39;student-123&#39;</span>))</span></span></code></pre></td></tr></table></div></div><p>The demo includes a static method on each Model to build its query. This is a convenient convention but not required by
Backslash; queries can be created anywhere in your application.</p><p>Here&rsquo;s a simple case for <code>CourseCapacityModel</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>buildQuery</span>(<span style=color:#a6e22e>string</span> $courseId)<span style=color:#f92672>:</span> <span style=color:#a6e22e>QueryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>in</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CourseCapacityChangedEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CourseDefinedEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>    )<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>and</span>(<span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;courseId&#39;</span>, $courseId));
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><p>This query loads events related to a single course&rsquo;s capacity.</p><h2 id=building-queries-with-eventclass-and-identifier>Building queries with EventClass and Identifier<a class=anchor href=#building-queries-with-eventclass-and-identifier>#</a></h2><p>Queries combine event class filters with identifier filters:</p><p><strong>EventClass filters:</strong></p><ul><li><code>EventClass::is(EventClass::class)</code> - Single event type</li><li><code>EventClass::in(Event1::class, Event2::class)</code> - Multiple event types</li></ul><p><strong>Identifier filters:</strong></p><ul><li><code>Identifier::is('key', 'value')</code> - Exact identifier match</li><li>Multiple identifiers can be combined</li></ul><p><strong>Combining filters:</strong></p><ul><li><code>->and()</code> - Both conditions must match</li><li><code>->or()</code> - Either condition must match</li></ul><h2 id=building-multi-entity-queries>Building multi-entity queries<a class=anchor href=#building-multi-entity-queries>#</a></h2><p>The <code>CourseSubscriptionModel</code> demonstrates a more complex query spanning multiple entities:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>buildQuery</span>(<span style=color:#a6e22e>string</span> $studentId, <span style=color:#a6e22e>string</span> $courseId)<span style=color:#f92672>:</span> <span style=color:#a6e22e>QueryInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $eventForThisCourseLifecycle <span style=color:#f92672>=</span> <span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>in</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CourseCapacityChangedEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>CourseDefinedEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>    )<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>and</span>(<span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;courseId&#39;</span>, $courseId));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $eventsForThisStudentLifecycle <span style=color:#f92672>=</span> <span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StudentRegisteredEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>    )<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>and</span>(<span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;studentId&#39;</span>, $studentId));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $eventsForThisStudentSubscriptions <span style=color:#f92672>=</span> <span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>in</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StudentUnsubscribedFromCourseEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StudentSubscribedToCourseEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>    )<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>and</span>(<span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;studentId&#39;</span>, $studentId));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $eventsForSubscriptionsToThisCourse <span style=color:#f92672>=</span> <span style=color:#a6e22e>EventClass</span><span style=color:#f92672>::</span><span style=color:#a6e22e>in</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StudentSubscribedToCourseEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>StudentUnsubscribedFromCourseEvent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>class</span>,
</span></span><span style=display:flex><span>    )<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>and</span>(<span style=color:#a6e22e>Identifier</span><span style=color:#f92672>::</span><span style=color:#a6e22e>is</span>(<span style=color:#e6db74>&#39;courseId&#39;</span>, $courseId));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $eventForThisCourseLifecycle
</span></span><span style=display:flex><span>        <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>or</span>($eventsForThisStudentLifecycle)
</span></span><span style=display:flex><span>        <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>or</span>($eventsForThisStudentSubscriptions)
</span></span><span style=display:flex><span>        <span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>or</span>($eventsForSubscriptionsToThisCourse);
</span></span><span style=display:flex><span>}</span></span></code></pre></td></tr></table></div></div><p>This query loads:</p><ul><li>The course&rsquo;s lifecycle events (definition and capacity changes)</li><li>The student&rsquo;s registration</li><li>All of this student&rsquo;s subscription events</li><li>All subscription events for this course (to count enrollments)</li></ul><p>This multi-entity boundary enables the Model to enforce rules like &ldquo;a student can only subscribe if the course isn&rsquo;t
full&rdquo; and &ldquo;a student can subscribe to at most 3 courses&rdquo;.</p><h2 id=best-practices>Best practices<a class=anchor href=#best-practices>#</a></h2><p><strong>Build queries per decision.</strong> Each business decision should define its own query that loads exactly the events needed.</p><p><strong>Start narrow, expand as needed.</strong> Begin with the minimal set of events and expand the query only when business rules
require additional context.</p><p><strong>Document complex queries.</strong> Multi-entity queries can be intricate; add comments explaining what events are loaded and
why.</p><p><strong>Use static factory methods.</strong> Place query building logic in static methods on your models for discoverability.</p><p><strong>Keep queries focused.</strong> Don&rsquo;t load events that aren&rsquo;t needed for the decision being made.</p><hr></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/backslash/event-sourcing/defining-events/ class="flex align-center"><img src=/backslash/icons/backward.svg class=book-icon alt=Previous title="Defining Events">
<span>Defining Events</span>
</a></span><span><a href=/backslash/event-sourcing/building-models/ class="flex align-center"><span>Building Models</span>
<img src=/backslash/icons/forward.svg class=book-icon alt=Next title="Building Models"></a></span></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#understanding-queries>Understanding queries</a></li><li><a href=#building-queries-with-eventclass-and-identifier>Building queries with EventClass and Identifier</a></li><li><a href=#building-multi-entity-queries>Building multi-entity queries</a></li><li><a href=#best-practices>Best practices</a></li></ul></nav></div></aside></main></body></html>